---
- name: BUILDAH | Create a buildah
  mafalb.buildah.buildah_from:
    name: fedora:latest
  register: __buildah

- name: BUILDAH | Get Ids
  ansible.builtin.shell: |
    executable: /bin/bash
    cmd: |
      set -o pipefail
      buildah ls | grep "{{ __buildah.stdout | trim }}$" | awk '{print $1}'
      buildah ls | grep "{{ __buildah.stdout | trim }}$" | awk '{print $3}'
  changed_when: false
  register: __buildah_ls

- name: BUILDAH | Test output of "buildah inspect <image_id>" command
  mafalb.buildah.buildah_inspect:
    name: "{{ __buildah_ls.stdout_lines[1] }}"
    type: image
  register: result

- name: BUILDAH | Debug
  ansible.builtin.debug:
    var: result.stdout_lines

- name: BUILDAH | Test output of "buildah inspect <container_id>" command
  mafalb.buildah.buildah_inspect:
    name: "{{ __buildah_ls.stdout_lines[0] }}"
    type: container
  register: result

- name: BUILDAH | Debug
  ansible.builtin.debug:
    var: result.stdout_lines
...
